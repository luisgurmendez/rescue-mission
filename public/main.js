(()=>{var t={466:function(t){var e;t.exports=((e=function(){function t(t){return n.appendChild(t.dom),t}function s(t){for(var e=0;e<n.children.length;e++)n.children[e].style.display=e===t?"block":"none";i=t}var i=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),s(++i%n.children.length)}),!1);var o=(performance||Date).now(),r=o,l=0,a=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new e.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:n,addPanel:t,showPanel:s,begin:function(){o=(performance||Date).now()},end:function(){l++;var t=(performance||Date).now();if(c.update(t-o,200),t>r+1e3&&(a.update(1e3*l/(t-r),100),r=t,l=0,u)){var e=performance.memory;u.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:n,setMode:s}}).Panel=function(t,e,s){var i=1/0,n=0,o=Math.round,r=o(window.devicePixelRatio||1),l=80*r,a=48*r,c=3*r,u=2*r,d=3*r,h=15*r,f=74*r,p=30*r,y=document.createElement("canvas");y.width=l,y.height=a,y.style.cssText="width:80px;height:48px";var m=y.getContext("2d");return m.font="bold "+9*r+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=s,m.fillRect(0,0,l,a),m.fillStyle=e,m.fillText(t,c,u),m.fillRect(d,h,f,p),m.fillStyle=s,m.globalAlpha=.9,m.fillRect(d,h,f,p),{dom:y,update:function(a,v){i=Math.min(i,a),n=Math.max(n,a),m.fillStyle=s,m.globalAlpha=1,m.fillRect(0,0,l,h),m.fillStyle=e,m.fillText(o(a)+" "+t+" ("+o(i)+"-"+o(n)+")",c,u),m.drawImage(y,d+r,h,f-r,p,d,h,f-r,p),m.fillRect(d+f-r,h,r,p),m.fillStyle=s,m.globalAlpha=.9,m.fillRect(d+f-r,h,r,o((1-a/v)*p))}}},e)},971:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(327),o=i(s(854)),r=s(215);e.default=class{getCollisions(t){const e={};for(let s=0;s<t.length;s++){const i=t[s];if(r.isCollisionableObject(i))for(let s=0;s<t.length;s++){const n=t[s];i!==n&&r.isCollisionableObject(n)&&this.calculateCollision(i,n)&&(void 0===e[i.id]?e[i.id]=[n]:e[i.id].push(n),i.onCollision&&i.onCollision(n))}}return e}calculateCollision(t,e){if(t.collisionMask instanceof n.Circle){if(e.collisionMask instanceof n.Circle)return l.isCircleIntersectingCircle(t.collisionMask,e.collisionMask,t.position,e.position);if(e.collisionMask instanceof n.Rectangle)return l.isRectangleIntersectingCircle(e.collisionMask,t.collisionMask,e.position,t.position)}if(t.collisionMask instanceof n.Rectangle){if(e.collisionMask instanceof n.Circle)return l.isRectangleIntersectingCircle(t.collisionMask,e.collisionMask,t.position,e.position);if(e.collisionMask instanceof n.Rectangle)return l.isRectangleIntersectingRectangle(e.collisionMask,t.collisionMask,e.position,t.position)}return!1}};class l{static isRectangleIntersectingCircle(t,e,s,i){const{x:n,y:o}=s,{x:r,y:l}=i,a=e.radius,c=n-t.w/2,u=n+t.w/2,d=o-t.h/2,h=o+t.h/2;let f=Math.max(c,Math.min(r,u))-r,p=Math.max(d,Math.min(l,h))-l;return f*f+p*p<=a*a}static isRectangleIntersectingRectangle(t,e,s,i){const n=new o.default(s.x-t.w/2,s.y+t.h/2),r=new o.default(s.x+t.w/2,s.y-t.h/2),l=new o.default(i.x-e.w/2,i.y+e.h/2),a=new o.default(i.x+e.w/2,i.y-e.h/2);return!(n.x==r.x||n.y==r.y||l.x==a.x||l.y==a.y||n.x>=a.x||l.x>=r.x||r.y>=l.y||a.y>=n.y)}static isCircleIntersectingCircle(t,e,s,i){const n=s.distanceTo(i);return console.log(n),n<=t.radius+e.radius}}},446:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(883);e.default=class{render(t){const{canvasRenderingContext:e,camera:s}=t;this.clearCanvas(e),this.safetlyRender(e,(()=>{e.scale(s.zoom,s.zoom),e.translate(t.camera.position.x,t.camera.position.y),t.objects.forEach((s=>{i.isRenderable(s)&&this.safetlyRender(e,(()=>{s.render(t)}))}))}))}clearCanvas(t){const e=t.canvas;t.clearRect(-1,-1,e.width,e.height)}safetlyRender(t,e){t.save(),e(),t.restore()}}},682:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(783);e.default=class{step(t){t.objects.forEach((e=>{i.isStepable(e)&&e.step(t)}))}}},764:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(327),o=i(s(854));e.default=class{constructor(){this.position=new o.default(document.body.scrollWidth/2,document.body.scrollHeight/2),this.viewport=new n.Rectangle(document.body.scrollWidth,document.body.scrollHeight),this._zoom=1,this.following=null}init(t){const e=t.canvas;let s=new o.default,i=!1;e.addEventListener("mousedown",(t=>{i=!0,s.x=t.clientX-this.position.x,s.y=t.clientY-this.position.y})),e.addEventListener("mouseup",(t=>{i=!1})),e.addEventListener("mouseover",(t=>{i=!1})),e.addEventListener("mouseout",(t=>{i=!1})),e.addEventListener("mousemove",(t=>{i&&(this.position.x=t.clientX-s.x,this.position.y=t.clientY-s.y)})),e.onwheel=t=>{t.preventDefault();const s=t.clientX-e.offsetLeft,i=t.clientY-e.offsetTop,n=t.deltaY<0?1:-1,o=Math.exp(.02*n),r=this.zoom;this.zoom=this.zoom*o,r!==this.zoom&&(this.position.x+=s/(this.zoom*o)-s/this.zoom,this.position.y+=i/(this.zoom*o)-i/this.zoom)}}follow(t){this.following=t}unfollow(){this.following=null}zoomIn(){this.zoom+=.5}zoomOut(){this.zoom-=.5}set zoom(t){this._zoom=t,t>5&&(this._zoom=5),t<.5&&(this._zoom=.5)}get zoom(){return this._zoom}step(t){null!==this.following&&(this.position=this.following.position.clone())}}},353:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static generateCanvas(){let t;const e=document.createElement("canvas"),s=document.getElementById("canvas-container");if(!s)throw Error("No canvas container");{const i=()=>{e.width=document.body.scrollWidth,e.height=document.body.scrollHeight,t.imageSmoothingEnabled=!0,t.translate(.5,.5)},n=e.getContext("2d");if(void 0===n)throw Error("Browser doesnt support canvas!");t=n,i(),s.appendChild(e),window.addEventListener("resize",i)}return t}}},753:(t,e)=>{"use strict";function s(){return("undefined"==typeof performance?Date:performance).now()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=s(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=s();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}},319:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(971)),o=i(s(446)),r=i(s(682)),l=i(s(891)),a=i(s(854)),c=i(s(814)),u=i(s(753)),d=i(s(839)),h=i(s(466)),f=i(s(426)),p=i(s(353)),y=i(s(764)),m=s(215),v=s(327);e.default=class{constructor(){this.objects=[],this.pressedKeys=new c.default,this.isPaused=!0,this.collisionController=new n.default,this.renderController=new o.default,this.stepController=new r.default,this.loop=t=>()=>{this.stats.begin(),t&&t(),this.update(),requestAnimationFrame(this.loop(t)),this.afterUpdate()},this.canvasRenderingContext=p.default.generateCanvas(),this.worldDimensions=new v.Rectangle(1e4,1e4),this.objects=[new f.default(new a.default),new l.default(new a.default(60,0))],this.clock=new u.default,this.pressedKeys=new c.default,this.camera=new y.default,this.stats=new h.default,this.stats.showPanel(0),document.body.appendChild(this.stats.dom),this.camera.init(this.canvasRenderingContext)}start(){this.isPaused=!1,this.clock.start()}stop(){this.isPaused=!0,this.clock.stop()}update(){const t=this.generateGameContext();console.log(t.camera.position),this.stepController.step(t),this.renderController.render(t)}afterUpdate(){this.stats.end()}generateGameContext(){const t=this.objects.filter(m.isCollisionableObject),e=this.collisionController.getCollisions(t),s=this.clock.getDelta();return new d.default(e,s,this.isPaused,this.objects,this.pressedKeys,this.canvasRenderingContext,this.camera)}}},839:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,s,i,n,o,r){this.collisions=t,this.dt=e,this.isPaused=s,this.objects=i,this.pressedKeys=n,this.canvasRenderingContext=o,this.camera=r}}},607:function(t,e,s){"use strict";var i=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{a(i.next(t))}catch(t){o(t)}}function l(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,l)}a((i=i.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=n(s(319));!function(){i(this,void 0,void 0,(function*(){(new o.default).loop((function(){}))()}))}()},883:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isRenderable=void 0,e.isRenderable=function(t){return"object"==typeof t&&void 0!==t.render}},783:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isStepable=void 0,e.isStepable=function(t){return"object"==typeof t&&void 0!==t.step}},977:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(704);e.default=class{constructor(t=function(){return Math.round(1e4*Math.random()).toString(16)}()){this.type=i.ObjectType.BASE_OBJECT,this.id=t}render(t){throw new Error("Method not implemented.")}step(t){throw new Error("Method not implemented.")}}},215:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.isCollisionableObject=void 0;const n=i(s(317)),o=s(704);class r extends n.default{constructor(t,e,s){super(e,s),this.collisionMask=t,this.type=o.ObjectType.COLLISIONABLE_OBJECT}onCollision(t){}}e.default=r,e.isCollisionableObject=function(t){return t instanceof r}},317:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(977)),o=s(704);class r extends n.default{constructor(t,e){super(e),this.position=t,this.type=o.ObjectType.GAME_OBJECT}}e.default=r},704:(t,e)=>{"use strict";var s;Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectType=void 0,(s=e.ObjectType||(e.ObjectType={}))[s.BASE_OBJECT=0]="BASE_OBJECT",s[s.GAME_OBJECT=1]="GAME_OBJECT",s[s.COLLISIONABLE_OBJECT=2]="COLLISIONABLE_OBJECT",s[s.PLANET=3]="PLANET",s[s.ROCKET=4]="ROCKET"},152:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(854));e.default=class{constructor(t){this.velocity=new n.default,this.direction=new n.default(0,1),this.acceleration=new n.default,this.mass=t||0}get speed(){return this.velocity.length()}isMoving(){return this.speed>0}}},426:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(327),o=i(s(157)),r=s(704),l=i(s(215));class a extends l.default{constructor(t){super(new n.Circle(100),t),this.gravitationalForce=1e4,this.type=r.ObjectType.PLANET}step(){}render(t){const e=t.canvasRenderingContext;e.save(),e.beginPath(),e.setLineDash([5,15]),e.arc(this.position.x,this.position.y,this.collisionMask.radius+300,0,2*Math.PI),e.stroke(),e.restore(),o.default.renderCircle(e,this.position,new n.Circle(1)),o.default.renderCircle(e,this.position,this.collisionMask)}}e.default=a},789:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(s(152)),o=i(s(202));class r extends n.default{constructor(t=1e3){super(t),this.hasLaunched=!1,this.thruster=new o.default(1e5,7607e3)}thrust(){const t=this.thruster.thrust();return t>0?this.mass/t:0}}e.default=r},891:function(t,e,s){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(327),o=i(s(854)),r=i(s(789)),l=s(704),a=i(s(157)),c=i(s(215)),u=i(s(426));class d extends c.default{constructor(t){super(new n.Rectangle(4,10),t),this.isColliding=!1,this.rocket=new r.default(549054),this.type=l.ObjectType.ROCKET,this.rocket.direction=new o.default(0,-1)}step(t){this.rocket.acceleration=this.getAcceleration(t),this.position=this.calculatePosition(t),this.rocket.velocity=this.calculateVelocity(t),this.isColliding=this.checkIsColliding(t),this.position.y>document.body.scrollHeight&&(this.rocket.acceleration.y=0,this.position.y=document.body.scrollHeight)}render(t){const e=t.canvasRenderingContext;this.isColliding&&(e.strokeStyle="#F00"),a.default.renderRectangle(e,this.position,this.collisionMask)}getAcceleration(t){const e=this.getThrustAcceleration(t);e.scalar(-1);const s=this.calculateAccelerationBySurroundingPlanets(t);return e.clone().add(s)}getThrustAcceleration(t){let e=new o.default;const s=t.pressedKeys.isKeyPressed;return s("w")&&(e=this.rocket.direction.clone().scalar(-40)),s("s")&&(e=this.rocket.direction.clone().scalar(40)),e}calculateAccelerationBySurroundingPlanets(t){const e=t.objects.filter((t=>t instanceof u.default)),s=new o.default;return e.forEach((t=>{const e=this.calculateAccelerationByPlanet(t);s.add(e)})),s}calculateVelocity(t){const e=this.rocket.velocity.clone(),s=this.rocket.acceleration.clone().scalar(t.dt);return e.add(s),e}calculatePosition(t){const e=this.position.clone(),s=this.rocket.acceleration.clone().scalar(Math.pow(t.dt,2)/2),i=this.rocket.velocity.clone().scalar(t.dt).add(s);return e.add(i),e}checkIsColliding(t){const e=t.collisions[this.id];return void 0!==e&&e.length>0}calculateDirection(t){return this.rocket.velocity.clone().normalize()}calculateAccelerationByPlanet(t){const e=this.position.distanceTo(t.position);if(e<t.collisionMask.radius+300){const s=new o.default(t.position.x-this.position.x,t.position.y-this.position.y).normalize();return console.log(e),s.scalar(t.gravitationalForce/(e*e)),s}return new o.default}}e.default=d},202:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.fuel=t,this.thrustPower=e}thrust(){return this.isEmpty()?0:(this.fuel-=1,this.thrustPower)}isEmpty(){return 0===this.fuel}}},327:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Circle=e.Rectangle=void 0,e.Rectangle=class{constructor(t,e){this.w=t,this.h=e}},e.Circle=class{constructor(t){this.radius=t}}},854:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t=0,e=0){this.x=t,this.y=e}clone(){return new s(this.x,this.y)}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}dotProduct(t){return this.x*t.x+this.y*t.y}lengthSq(){return Math.pow(this.x,2)+Math.pow(this.y,2)}length(){return Math.sqrt(this.lengthSq())}normalize(){const t=this.length();return this.x/=t,this.y/=t,this}scalar(t){return this.x*=t,this.y*=t,this}add(t){return this.set(this.x+t.x,this.y+t.y),this}sub(t){return this.set(this.x-t.x,this.y-t.y),this}negate(){this.scalar(-1)}set(t,e){return this.x=t,this.y=e,this}angleTo(t){return Math.atan2(this.y,this.x)-Math.atan2(t.y,t.x)}static angleTo(t,e){return Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x)}}e.default=s},814:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SPACE=e.DOWN=e.RIGHT=e.UP=e.LEFT=void 0,e.LEFT="ArrowLeft",e.UP="ArrowUp",e.RIGHT="ArrowRight",e.DOWN="ArrowDown",e.SPACE=" ",e.default=class{constructor(){this.keyUpHanlder=t=>{this.pressedKeys[t.key]=!1},this.keyDownHanlder=t=>{this.pressedKeys[t.key]=!0},this.isKeyPressed=t=>!!this.pressedKeys[t],this.pressedKeys={[e.UP]:!1,[e.RIGHT]:!1,[e.DOWN]:!1,[e.LEFT]:!1},document.addEventListener("keydown",this.keyDownHanlder),document.addEventListener("keyup",this.keyUpHanlder)}clean(){document.removeEventListener("keydown",this.keyDownHanlder),document.removeEventListener("keyup",this.keyUpHanlder)}}},157:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static renderCircle(t,e,s){t.beginPath(),t.arc(e.x,e.y,s.radius,0,2*Math.PI),t.stroke()}static renderRectangle(t,e,s){t.beginPath(),t.rect(e.x-s.w/2,e.y-s.h/2,s.w,s.h),t.stroke()}static renderText(){}}}},e={};!function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,s),o.exports}(607)})();